
<head>
<link rel="stylesheet" href="all.css" type="text/css"> 
<title>自制可视化编辑器</title>
<style>
body{
font-size:100%;
}
fixed-blue-button{
font-size:100%;
color:white;
background:#6699ff;
border:none;
border-radius:6px;
padding:1rem 3rem;
-webkit-box-shadow: 0 0 6px 0 rgba(0, 0, 0, 0.3);
-moz-box-shadow: 0 0 6px 0 rgba(0, 0, 0, 0.3);
box-shadow: 0 0 6px 0 rgba(0, 0, 0, 0.3);
z-index:100;
}
fixed-blue-button:hover{
color:white;
background:rgba(102, 153, 255,75%)
}
blue-button{
display:inline-block;
font-size:1rem;
color:white;
background:#6699ff;
border:none;
border-radius:6px;
padding:1rem 2rem;
margin:0rem 0 0 8rem;
height:3.4rem;
width:auto;
-webkit-box-shadow: 0 0 6px 0 rgba(0, 0, 0, 0.3);
-moz-box-shadow: 0 0 6px 0 rgba(0, 0, 0, 0.3);
box-shadow: 0 0 6px 0 rgba(0, 0, 0, 0.3);
z-index:100;
}
blue-button:hover{
color:white;
background:rgba(102, 153, 255,75%)
}
blue-button button{
color:white;
border:none;
position:relative;
width:100%;
height:100%;
top:0%;
left:0%;
padding:auto;
}
#fc-nav div,#bc-nav div{
background:url('https://z3.ax1x.com/2021/08/17/f5Evm4.jpg') no-repeat center center;
-webkit-background-clip: text;
background-clip: text;
color:transparent;
}

input{
display:none;
padding:1rem 1rem;
width:2rem;
height:2rem;
background:url('https://z3.ax1x.com/2021/08/17/f5Evm4.jpg') no-repeat center center;
background-size:cover;
border-radius:50px;
border:none;
outline: 0;
}
blue-button button:hover{
color:white;
background:transparent;
}
k{
border-style:none none solid none;
border-bottom:4px solid cornflowerblue;
padding-bottom:2px;
}

u{
padding:0.1rem 0rem;
text-decoration:none;
border-bottom:solid 1px #555;
}
u:hover{
border-bottom:solid 1px #6483B0;
}
ol{
margin:0 1.5rem 0 0;
width:85%;
padding:0 0 0 2rem;
display:flex;
flex-direction:column;
}
ol a{
font-size:0.9rem;
display:block;
text-align:justify; 
text-justify:inter-ideograph;
padding:0rem 0;
margin:0.3rem 0;
color:black;
text-decoration:none;
outline:none;
user-select: none;
}
ol a:hover,a:active,a:visited,a:link,a:focus{
-webkit-tap-highlight-color:rgba(0,0,255,0);
tap-highlight-color:rgba(0,0,255,0);
}
ol a:link{
}
ol li:hover{
color:#6483B0;
}
ol a:hover{
color:#6483B0;
}
ol a:active{
}
ol a:visited{
}




#textarea{
font-size:200%;
top:500;
right:5%;
left:5%;
height:450;
background:white;
position:fixed;
outline:none;
padding:4rem 3rem 6rem 3rem;
overflow:auto;
border-top: 1px rgba(128,128,128,1.00) solid;
border-right: 0px rgba(0,84,138,1.00) solid;
border-bottom: 0px rgba(0,84,138,1.00) solid;
border-left: 0px rgba(0,84,138,1.00) solid;
resize: vertical;
box-shadow: 5px 5px 20px rgba(128,128,128,0.7);
}
.output{
font-size:200%;
position:fixed;
top:1130;
right:50;
}
#output{
display:inline-block;
}

#getCode-button:hover #code{
display:block;
}

#code{
display:none;
font-size:60%;
top:500;
left:5%;
width:882;
height:612;
border:solid 1px black;
position:fixed;
outline:none;
padding:4rem 3rem 6rem 3rem;
overflow:auto;
z-index:1;
}
#getCode{

}


#button1{
border-left:solid;
border-right:solid;
border-top:solid;
    display: -webkit-flex;
    display: flex;
    -webkit-flex-wrap: wrap;
    flex-wrap: wrap;
    -webkit-justify-content: center;
    justify-content: center;
    position:fixed;
left:5%;
right:5%;
top:55;
height:auto;
z-index:2;
}
#button1 button{
z-index:2;
}

#button2{
border-left:solid;
border-right:solid;
    display: -webkit-flex;
    display: flex;
    -webkit-flex-wrap: wrap;
    flex-wrap: wrap;
    -webkit-justify-content: center;
    justify-content: center;
    position:fixed;
left:5%;
right:5%;
top:145;
height:auto;
z-index:4;
}

#button3{
border-left:solid;
border-right:solid;
border-bottom:solid;
    display: -webkit-flex;
    display: flex;
    -webkit-flex-wrap: wrap;
    flex-wrap: wrap;
    -webkit-justify-content: center;
    justify-content: center;
    position:fixed;
left:5%;
right:5%;
top:323;
height:auto;
z-index:2;
}



button,surbutton{
background:#f0f8ff;
color:#555;
background:white;
display:flex;
height:5.5rem;
width:6.5rem;
font-size:4rem;
border:solid;
padding:0 auto;
outline:none;
text-align:center;
align-items:center;
line-height:5.5rem
}
button:hover{
color:#000;
}
surbutton:hover{
color:#000;
}



/*工具栏*/
#tool-nav{
display:none;
}
#tool-button{
z-index:10;
}
#tool-button:hover #tool-nav{
position:fixed;
z-index:10;
top:0%;
right:0%;
left:0%;
display:flex;
flex-wrap:wrap;
padding:20rem 10rem 0 10rem;
background-image:url('https://z3.ax1x.com/2021/08/17/f51Tzj.jpg');
background-size:cover;
opacity:0.75;
height:200px;
}
#tool-nav button{
z-index:10;
display:inline-block;
background:transparent;
}

#search-button{
}
#searched-button{
display:none;
}
#tool-button:hover #searched-button{
display:none;
}
#search-button:hover #searched-button{
display:block;
position:fixed;
top:1%;
right:1%;
z-index:100;
}



/*字体*/
#fc-nav,#bc-nav{
display:none;
}
#fc-thecolor,#bc-thecolor{
font-size:2rem;
line-height:3rem;
}
#fc-btn,#bc-btn{
font-size:2rem;
line-height:3rem;
}
#fc-button,#bc-button{
display:block;
}
#fc-button:hover #fc-nav{
position:fixed;
z-index:10;
top:0%;
right:0%;
left:0%;
display:flex;
flex-wrap:wrap;
font-size:1rem;
padding:10rem 10rem 10rem 10rem;
background-image:url('https://z3.ax1x.com/2021/08/17/f51Tzj.jpg');
background-size:cover;
opacity:0.98;
height:200px;
}
#fc-button:hover #fc-thecolor{
display:block;
}

#bc-button:hover #bc-nav{
position:fixed;
z-index:10;
top:0%;
right:0%;
left:0%;
display:flex;
flex-wrap:wrap;
font-size:1rem;
padding:10rem 10rem 10rem 10rem;
background-image:url('https://z3.ax1x.com/2021/08/17/f51Tzj.jpg');
background-size:cover;
opacity:0.98;
height:200px;
}
#bc-button:hover #bc-thecolor{
display:block;
}





#f-nav{
display:none;
}
#f-button:hover #f-nav{
position:fixed;
z-index:10;
top:0%;
right:0%;
left:0%;
display:flex;
flex-wrap:wrap;
padding:10rem 10rem 10rem 10rem;
background-image:url('https://z3.ax1x.com/2021/08/17/f51Tzj.jpg');
background-size:cover;
opacity:1.0;
height:200px;
}
#f-nav button{
z-index:10;
display:inline-block;
background:transparent;
}





#ff-nav{
display:none;
}
#ff-button:hover #ff-nav{
position:fixed;
z-index:10;
top:0%;
right:0%;
left:0%;
display:block;
background-image:url('https://z3.ax1x.com/2021/08/17/f51Tzj.jpg');
background-size:cover;
opacity:0.75;
padding:5rem 10rem;
height:400px;
}
#ff-nav button{
font-size:2.9rem;
display:block;
height:4.6rem;
width:auto;
background:transparent;
}
#fs-nav{
display:none;
}
#fs-button:hover #fs-nav{
position:fixed;
display:block;
position:fixed;
z-index:10;
top:0%;
right:0%;
left:0%;
display:block;
color:black;
background-image:url('https://z3.ax1x.com/2021/08/17/f51Tzj.jpg');
opacity:0.75;
background-size:cover;
padding:14rem 5rem;
height:100px;
}
#fs-nav button{
font-size:4rem;
display:inline-block;
height:6rem;
width:6rem;
background:transparent;
}

#h-nav{
display:none;
}
#h-button:hover #h-nav{
position:fixed;
display:block;
}

#j-nav{
display:none;
}
#j-button:hover #j-nav{
position:fixed;
display:block;
}



#insert-nav{
display:none;
}
#insert-button{
z-index:10;
}
#insert-button:hover #insert-nav{
position:fixed;
z-index:10;
top:0%;
right:0%;
left:0%;
display:flex;
flex-wrap:wrap;
padding:20rem 10rem 0 10rem;
background-image:url('https://z3.ax1x.com/2021/08/17/f51Tzj.jpg');
background-size:cover;
opacity:0.75;
height:200px;
}
/*插入*/
#href{
display:none;
top:20%;
left:20%;
width:80%;
height:40%;
}
#a2-button{
display:none;
}
#a-button:hover #a2-button{
position:fixed;
display:block;
}
#a-button:hover #href{
position:fixed;
display:block;
}



#img-button{
}
#imagefile{
z-index:-1;
visible:hidden;
opacity:0;
filter:alpha(opacity=0);
}

#img2-button{
display:none;
}
#img-button:hover #img2-button{
position:fixed;
display:inline-block;
top:30%;
left:80%;
}




#mark2-button{
display:none;
}
#mark-tip{
}




#self-nav{
display:none;
}
#self-button:hover #self-nav{
position:fixed;
z-index:10;
top:0%;
right:0%;
left:0%;
display:flex;
flex-wrap:wrap;
padding:10rem 10rem 10rem 10rem;
background-image:url('https://z3.ax1x.com/2021/08/17/f51Tzj.jpg');
background-size:cover;
opacity:1.0;
height:200px;
}
#self-nav button{
z-index:10;
font-size:2rem;
position: absolute;           
top: 20px;            
left: 100px;
width:auto;
display:inline-block;
background:transparent;
}



/*提示语*/
.sky-container{
display:flex;
justify-content: center;
width:100%;
left:0;
z-index:1000;
}
.finish-tip{
display:none;
position:fixed;
right:0;
left:0;
bottom:10%;
width:10rem;
margin:0 auto;
padding: 16px 32px;
text-align:center;
font-size:100%;
 background-color:#F7F8FA;
 color: black;
 border-radius: 50px;
z-index:1000;
zoom:1.8;
}
.do-tip{
display:none;
position:fixed;
top:10%;
width:auto;
margin:0 auto;
padding: 16px 32px;
text-align:center;
font-size:100%;
 background-color:#FA8072;
 color: #F0F8FF;
 border-radius: 50px;
z-index:100;
zoom:1.8;
}
.notice-tip{
display:none;
position:fixed;
top:10%;
width:auto;
margin:0 auto;
padding: 16px 32px;
text-align:center;
font-size:100%;
 background-color:#FA8072;
 color: #F0F8FF;
 border-radius: 50px;
z-index:100;
zoom:1.8;
}
table.tftable {
text-align:center;
font-size:100%;
color:#333333;
width:100%;
border-width: 0.5px;
border-color: rgba(84,100,93,60%);
border-collapse: collapse;
}
table.tftable th {
font-weight:400;
font-size:100%;
background-color:rgb(210,236,228);
border-width: 1px;
padding: 15px;
border-style: solid;
border-color: white;
}
table.tftable tr {
background-color:#ffffff;
}
table.tftable td {
font-size:100%;
border-width: 0.5px;
padding: 15px;
border-style: solid;
border-color: rgba(84,100,93,60%);
}



</style>
</head>







<body>
<div id="textarea" contenteditable="true" onkeyup="wordCount()">
<p>   
<br>
</p>
<hr>
<b>参考</b>
<ol id="ol">
<li style="display:none;"> <a></a></li>
</ol>
</div>

<div class="output">words:
<div id="output"></div>
</div>


<div id="button2">
<button id="undo-button" onclick="un()" style="">
<
</button>
<button id="redo-button" onclick="redo()">
>
</button>


<surbutton id="tool-button">功能键
<div id="tool-nav">
<button onclick="replace()">≒</button>

<div id="search-button">
<surbutton onclick="search()">⎋</surbutton>
<button onclick="searched()" id="searched-button">完成
</button>
</div>

<button id="rf-button" onclick="rf()">₡ </button>

<button id="copy-button" onclick="copy()">⧉</button>
</div>
</surbutton>




<button id="inserttext-button" onclick="insertText()" style="font-size:300%">insertText</button>



<button id="getCode-button" onclick="getCode();" style="font-size:200%;align-items:center;line-height:5.5rem">HTML
<textarea id="code">
</textarea>
</button>





<surbutton id="f-button">字体
<div id="f-nav">
<surbutton id="ff-button">A
<div id="ff-nav">
<button id="ff1-button" onclick="ff1()">sans-serif</button>
<button id="ff2-button" onclick="ff2()">serif</button>
<button id="ff3-button" onclick="ff3()">cursive</button>
<button id="ff4-button" onclick="ff4()">monospace</button>
<button id="ff5-button" onclick="ff5()">courier</button>
</div></surbutton>




<surbutton id="fs-button">S
<div id="fs-nav">
<button id="fs1-button" onclick="fs1()">1</button>
<button id="fs2-button" onclick="fs2()">2</button>
<button id="fs3-button" onclick="fs3()">3</button>
<button id="fs4-button" onclick="fs4()">4</button>
<button id="fs5-button" onclick="fs5()">5</button>
<button id="fs6-button" onclick="fs6()">6</button>
<button id="fs7-button" onclick="fs7()">7</button>
</div></surbutton>


<button id="b-button" onclick="b()"><b>A</b></button>
<button id="i-button" onclick="i()"><i>A</i></button>
<button id="u-button" onclick="u()"><u>A</u></button>
<button id="s-button" onclick="s()"><s>A</s></button>

<button id="super-button" onclick="superscript()"> A<super style="display:inline-block;position:absolute;top:-20px;right:17%;zoom:0.9;">a</super></button>

<button id="sub-button" onclick="subscript()">A<sub style="display:inline;line-height:5.5rem;vertical-align:sub">a</sub></button>

<surbutton id="fc-button">
<font color="cyan">A</font>
<div id="fc-nav">
<input type="color" id="fc-thecolor" style="zoom:3" value="" /><div style="margin:0 2rem;font-size:2.4rem">« 选择</div>
<blue-button style="background:url('https://z3.ax1x.com/2021/08/17/f5Evm4.jpg') center;background-size:cover"><button id="fc-btn" onclick="fc()">设置</button></blue-button>
</div>
</surbutton>


<surbutton id="bc-button">
<button id="bc-button"><div style="background:yellow;padding:0rem 1.5rem">A</div></button>
<div id="bc-nav">
<input type="color" id="bc-thecolor" style="zoom:3" value="" /><div style="margin:0 2rem;font-size:2.4rem">« 选择</div>
<blue-button style="background:url('https://z3.ax1x.com/2021/08/17/f5Evm4.jpg') center;background-size:cover"><button id="bc-btn" onclick="bc()">设置</button></blue-button>
</div>
</surbutton>




</div></surbutton>



<!--插入-->
<button id="t-button" onclick="creatTab()" style="font-size:400%">▦</button>

<!--链接-->

<button id="a-button" onclick="a()">∽</button>




<button id="pre-button" onclick="pre()">&lt;/&gt;</button>


<!--图片-->
<div id="img-button">
<button id="img1-button" /*style="padding:0rem 0rem 0 1.1rem"*/>    
￼
<input type="file" id="imagefile" value=" ">
</button>
<button id="img2-button" onclick="img();">插入</button>
</div>



<surbutton id="insert-button">插入
<div id="insert-nav">
/*注释*/

/*参考文献*/
<button id="r-button" onclick="reference()">[1]</button>
<!--锚点-->
<button id="mark-button" onclick="bookmark()">
<svg t="1629391119689" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2026" width="50" height="50"><path d="M977.322163 465.530193a46.539151 46.539151 0 0 0-46.539151 46.53915 418.852355 418.852355 0 0 1-372.313205 416.199624V366.355263a186.156602 186.156602 0 1 0-93.078301 0v561.913704A418.852355 418.852355 0 0 1 93.078301 512.069343a46.539151 46.539151 0 0 0-93.078301 0 511.930657 511.930657 0 0 0 1023.861313 0 46.539151 46.539151 0 0 0-46.53915-46.53915zM418.852355 186.295289a93.078301 93.078301 0 1 1 93.078302 93.078301 93.078301 93.078301 0 0 1-93.078302-93.078301z" p-id="2027" fill="#555555"></path></svg>
</button>
<button id="mark2-button">添加链接</button>
</div>
</surbutton>


<div class="sky-container">
<div class="finish-tip">已完成</div>

<div id="mark-tip" class="do-tip">请选择合适文本位置添加对应链接</div>
<div id="aud-tip" class="notice-tip">请注意，取消“取消自动链接行为”时，链接样式将不会保存。</div>

</div>





</div>



<div id="button3">


<!--排版-->

<button id="iu-button" onclick="iu()" >≔</button>
<button id="io-button" onclick="io()" style="font-family:serif">I</button>
<!--段落-->
<button id="in-button" onclick="indent()">⇥</button>
<button id="out-button" onclick="outdent()">⇤</button>

<button id="p-button" onclick="p()">↩</button>

<button id="hr-button" onclick="hr()">---</button>

<surbutton id="j-button">≡
<div id="j-nav">
<button id="jf-button" onclick="jf()">|=|</button>
<button id="jc-button" onclick="jc()"> =</button>
<button id="jl-button" onclick="jl()">|=</button>
<button id="jr-button" onclick="jr()">=|</button>
</div>
</surbutton>

<surbutton id="h-button">«»
<div id="h-nav">
<button id="h1-button" onclick="h1()">一级标题</button>
<button id="h2-button" onclick="h2()">二级标题</button>
<button id="h3-button" onclick="h3()">三级标题</button>
<button id="h4-button" onclick="h4()">四级标题</button>
<button id="h5-button" onclick="h5()">五级标题</button>
<button id="h6-button" onclick="h6()">六级标题</button>
</div>
</surbutton>

<surbutton id="self-button">自定义

<div id="self-nav" onclick="aud()">
<button id="aud-button">更改自动链接行为</button>
<div class="kaiguan" id="self-kaiguan">
<div class="bai" id="self-anniu"></div>
</div>
</div>

</surbutton>


</div>






</body>


<!-- 
<button id="open-button" onclick="open()">打开</button>
<button id="saveas-button" onclick="saveas()">另存为</button>
-->


//更改自动链接行为（伪）
function aud() {
var anniu =document.getElementById('self-anniu');
var kaiguan = document.getElementById('self-kaiguan');
var as = document.getElementsByTagName("a");
var tip = document.getElementsById("aud-tip");

var temp = 1;
anniu.addEventListener('click',function(){
if(temp==1){
this.className = 'hei';              
temp=0;                
kaiguan.style.border= '2px solid  rgb(11, 243, 81)';               
tip.style.display="block";
setTimeout(function(){
tip.style.display="none"},12000);
for(var i=0;i<as.length;i++){      
var a=as[i];      
a.style.color="black";
a.style.textDecoration="none";
a.style.borderBottom="none";
    }
            
}else{                
this.className = 'bai';               
temp=1;               
kaiguan.style.border= '2px solid black';               

for(var i=0;i<as.length;i++){      
var a=as[i];      
a.style.color="black";
a.style.borderBottom="4px solid #6483B0";}
}
})
}


<!--添加参考文献 -->
<script>

function reference() {
var n = prompt("锚点名","");
var c = prompt("参考文献","");
        if(n!=null&&c!=null){
var content = window.getSelection().toString();
var html='<element id="'+ n + '">' + content + '</element>';
var sel, range;
    if (window.getSelection) {
        sel = window.getSelection();
        if (sel.getRangeAt && sel.rangeCount) {
            range = sel.getRangeAt(0);
            range.deleteContents();
            var el = document.createElement("div");
            el.innerHTML = html;
            var frag = document.createDocumentFragment(), node, lastNode;
            while ( (node = el.firstChild) ) {
                lastNode = frag.appendChild(node);
            }
            range.insertNode(frag);
            if (lastNode) {
                range = range.cloneRange();
                range.setStartAfter(lastNode);
                range.collapse(true);
                sel.removeAllRanges();
                sel.addRange(range);
            }
        }
    } else if (document.selection && document.selection.type != "Control") {     document.selection.createRange().pasteHTML(html);
    };

var node=document.createElement("a");
var textnode=document.createTextNode(c);
node.appendChild(textnode);
document.getElementById("ol").appendChild(node);
node.href = "#"+n;

var nodeList = document.getElementsByTagName('a');
var arrNodes = Array.prototype.slice.call(nodeList);  
var order=arrNodes.indexOf(node);

var e = node.outerHTML;
node.outerHTML= "<li>" + e +"</li>";

var e = document.getElementById(n).innerHTML;
document.getElementById(n).innerHTML= e + "<span style='color:#6483B0;vertical-align:super;margin:0 0.2rem 0 0rem;zoom:0.5'>" + order + "</span>";
}}
</script>

<script>

<!-- 书签（锚点链接）-->

function bookmark() {
var n = prompt("填写锚点名称","");
        if(n!=null&&n!=''){
var content = window.getSelection().toString();
var html='<element id="'+ n + '">' + content + '</element>';
var sel, range;
    if (window.getSelection) {
        sel = window.getSelection();
        if (sel.getRangeAt && sel.rangeCount) {
            range = sel.getRangeAt(0);
            range.deleteContents();
            var el = document.createElement("div");
            el.innerHTML = html;
            var frag = document.createDocumentFragment(), node, lastNode;
            while ( (node = el.firstChild) ) {
                lastNode = frag.appendChild(node);
            }
            range.insertNode(frag);
            if (lastNode) {
                range = range.cloneRange();
                range.setStartAfter(lastNode);
                range.collapse(true);
                sel.removeAllRanges();
                sel.addRange(range);
            }
        }
    } else if (document.selection && document.selection.type != "Control") {     
document.selection.createRange().pasteHTML(html);
    };
document.getElementById("button2").style.zIndex="0";
document.getElementById("mark2-button").style.display="block";
document.getElementById("mark-tip").style.display="block";
document.getElementById("mark2-button").addEventListener("click", function(){
document.getElementById("mark-tip").style.display="none";
document.execCommand('CreateLink', true, "#"+n);
document.getElementById("mark2-button").style.display="none";
document.getElementById("button2").style.zIndex="4"
});



}}





<!--替换-->
function replace() {
var A = prompt("替换内容","");
var B = prompt("替换为","");
        if(A!=null&&A!=''&&B!=null&&B!=''){
var str = document.getElementById("textarea").innerHTML;
document.getElementById("textarea").innerHTML= str.replace(new RegExp(A , "g"), B);
}
}
<!--查找-->
function search() {
var C = prompt("查找内容","");
        if(C!=null&&C!=''){
var str = document.getElementById("textarea").innerHTML;
var D = "<k>" + C + "</k>";
document.getElementById("textarea").innerHTML= str.replace(new RegExp(C , "g"), D);

document.getElementById("searched-button").addEventListener('click',function searched() {
document.getElementById("textarea").innerHTML= str.replace(new RegExp(D , "g"), C);})

}
}




<!--字数统计 -->
function wordCount() {
var length = document.getElementById("textarea");
document.getElementById("output").innerHTML= length.innerHTML.length;
}


<!-- 获取html代码-->
function getCode() {
var code = document.getElementById("textarea").innerHTML;
document.getElementById("code").innerText = code;
} 



function copy() {
document.execCommand("Copy")
};
//字体;
function ff() {
document.execCommand("FontName","false",sFontName);
};



function ff1() {
document.execCommand("FontName","false","sans-serif");
};
function ff2() {
document.execCommand("FontName","false","serif");
};
function ff3() {
document.execCommand("FontName","false","cursive");
};
function ff4() {
document.execCommand("FontName","false","monospace");
};
function ff5() {
document.execCommand("FontName","false","courier");
};

       
//字体大小;
function fs() {
document.execCommand("FontSize","false","7");
};
function fs1() {
document.execCommand("FontSize","false","1");
};
function fs2() {
document.execCommand("FontSize","false","2");
};
function fs3() {
document.execCommand("FontSize","false","3");
};
function fs4() {
document.execCommand("FontSize","false","4");
};
function fs5() {
document.execCommand("FontSize","false","5");
};
function fs6() {
document.execCommand("FontSize","false","6");
};
function fs7() {
document.execCommand("FontSize","false","7");
};

//加粗;
function b() {
document.execCommand("Bold","false",null);
}; 
//斜体   
function i(){
document.execCommand('Italic');   
};
//下划线
function u() {
document.execCommand("Underline")
} ;
//删除线
function s() {
document.execCommand("StrikeThrough")
} ;
//上标
function superscript(){
document.execCommand("SuperScript")
} ;
//下标
function subscript(){
document.execCommand('subscript', 'false', null);
};
//设置文字颜色;
function fc(){
var color =document.getElementById("fc-thecolor").value;
document.execCommand("ForeColor","false",color);
};
//设置背景颜色;
function bc(){
var color =document.getElementById("bc-thecolor").value;
document.execCommand("BackColor","false",color);
};
//链接
function a() {
var a = prompt("输入链接内容","");
        if(a!=null&&a!=''){
document.execCommand('CreateLink', true, a);
};
}
//图片
function img(){
if(typeof FileReader=='undifined'){result.innerHTML="<p>抱歉，你的浏览器不支持 FileReader</p>";return false;}var file=document.getElementById("imagefile").files[0];
if(!/image\/\w+/.test(file.type))           
{alert("请确保文件为图像文件");return false;}
var reader=new FileReader();
reader.readAsDataURL(file);
reader.onload=function(e){
document.execCommand("insertImage",true,this.result)
}}
//显示代码
function pre(){
document.execCommand("FormatBlock",false,"<PRE>")
};
//标题
function h1(){
document.execCommand("FormatBlock","false","<h1>")
};
function h2(){
document.execCommand("FormatBlock","false","<h2>")
};
function h3(){
document.execCommand("FormatBlock","false","<h3>")
};
function h4(){
document.execCommand("FormatBlock","false","<h4>")
};
function h5(){
document.execCommand("FormatBlock","false","<h5>")
};
function h6(){
document.execCommand("FormatBlock","false","<h6>")
};

//缩进
function indent(){
document.execCommand('Indent');  
};
//减少缩进
function outdent(){
document.execCommand('outdent', 'false', null );
};
//分割线
function hr() {
document.execCommand("InsertHorizontalRule")
} ;
//换行
function p() {
document.execCommand("InsertParagraph")
} 
//文本对齐
function jf() {
document.execCommand('justifyFull', 'false', null );
};
//文本居中
function jc(){
document.execCommand('justifyCenter', 'false', null );
};
//文本左对齐
function jl(){
document.execCommand('justifyLeft', 'false', null );
};
//文本右对齐
function jr(){
document.execCommand('justifyRight', 'false', null );
};
//无序列排列   
function iu(){
document.execCommand('InsertUnorderedList');   
};

//有序列排列   
function io(){
document.execCommand('InsertOrderedList');   
};


//撤销
function un() {
document.execCommand('undo', 'false', null );
} ;
//恢复
function redo() {
document.execCommand('redo', 'false', null );
} ;
//清除格式
function rf() {
document.execCommand('RemoveFormat')
} 
//表格
function creatTab(){
var rows = prompt("rows"," ");
var cols = prompt("cols"," ");


var th = document.createElement('th');

    var tab = '<table id="tfhover" class="tftable" border="1" contenteditable="true">'
/* 表头*/
            tab=tab+"<tr>";
        for(var j=0;j<cols;j++){
            tab+="<th>"+1+j+"</th>";
        }
        tab+="<tr/>";
    

/*主体*/
    for(var i=0;i<rows;i++){
        tab=tab+"<tr>";
        for(var j=0;j<cols;j++){
            tab+="<td>"+i+j+"</td>";
        }
        tab+="<tr/>";
    }
    tab+='</table>';

var html=tab;
/*来源：https://blog.csdn.net/fesfsefgs/article/details/109540259?utm_medium=distribute.wap_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-1.wap_blog_relevant_pic&depth_1-utm_source=distribute.wap_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-1.wap_blog_relevant_pic*/
var sel, range;
    if (window.getSelection) {
        sel = window.getSelection();
        if (sel.getRangeAt && sel.rangeCount) {
            range = sel.getRangeAt(0);
            range.deleteContents();
            var el = document.createElement("div");
            el.innerHTML = html;
            var frag = document.createDocumentFragment(), node, lastNode;
            while ( (node = el.firstChild) ) {
                lastNode = frag.appendChild(node);
            }
            range.insertNode(frag);

            // Preserve the selection
            if (lastNode) {
                range = range.cloneRange();
                range.setStartAfter(lastNode);
                range.collapse(true);
                sel.removeAllRanges();
                sel.addRange(range);
            }
        }
    } else if (document.selection && document.selection.type != "Control") {     document.selection.createRange().pasteHTML(html);
    }
}


//废用
<!--
function aud() {
var as = document.getElementsByTagName("a");
for(var i=0;i<as.length;i++){
        var a=as[i];
        a.style.color="black";
a.style.textDecoration="none";
a.style.borderBottom="none";
    }
}     
-->


<!--不会使用-->
function open() {
document.execCommand("Open")
} ;
function saveas() {
document.execCommand("SaveAs","hi.txt")
};
//更改自动链接行为
//function aud() {
//document.execCommand("AutoUrlDetect",true)
//} 



<!--目前暂定不用-->
function insertText(){
document.execCommand('insertText', 'false', "<hi>");
};

</script>










