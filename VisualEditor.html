


<title>自制可视化编辑器</title>
<style>
body{
font-size:100%;
}

#textarea{
font-size:200%;
top:30%;
right:10%;
left:10%;
height:40%;
border:solid 1px black;
position:absolute;
}
#code{
top:50%;
left:10%;
height:20%;
}



table.tftable {
text-align:center;
font-size:100%;
color:#333333;
width:100%;
border-width: 0.5px;
border-color: rgba(84,100,93,60%);
border-collapse: collapse;
}
table.tftable th {
font-weight:400;
font-size:100%;
background-color:rgb(210,236,228);
border-width: 1px;
padding: 15px;
border-style: solid;
border-color: white;
}
table.tftable tr {
background-color:#ffffff;
}
table.tftable td {
font-size:100%;
border-width: 0.5px;
padding: 15px;
border-style: solid;
border-color: rgba(84,100,93,60%);
}








.button{
    display: -webkit-flex;
    display: flex;
    -webkit-flex-wrap: wrap;
    flex-wrap: wrap;
    -webkit-justify-content: center;
    justify-content: center;
    position:absolute;
left:0;
top:10%;
width:90%;
height:auto;
margin-left:auto;
margin-right:auto;
z-index:1;

}
button{
display:inline-block;
height:5rem;
width:auto;
font-size:200%;
color:white;
background:#6699ff;
border:none;
border-radius:6px;
padding:1rem 3rem;
-webkit-box-shadow: 0 0 6px 0 rgba(0, 0, 0, 0.3);
-moz-box-shadow: 0 0 6px 0 rgba(0, 0, 0, 0.3);
box-shadow: 0 0 6px 0 rgba(0, 0, 0, 0.3);
}
button:hover{
color:white;
background:rgba(102, 153, 255,75%)
}





#getCode{
order:1;
}
#href{
display:none;
top:20%;
left:20%;
width:80%;
height:40%;
}
#a2-button{
display:none;
}
#a-button:hover #a2-button{
display:block;
}
#a-button:hover #href{
display:block;
}



#img-button{
}
#imagefile{
z-index:-1;
visible:hidden;
opacity:1;
filter:alpha(opacity=100);
}

#img2-button{
display:none;
}
#img-button:hover #img2-button{
display:inline-block;
top:30%;
left:80%;
}


#fc-thecolor,#bc-thecolor,#fc-btn,#bc-btn{
display:none;
}
#fc:hover #fc-thecolor{
display:block;
}
#fc:hover #fc-btn{
display:block;
}
#bc:hover #bc-thecolor{
display:block;
}
#bc:hover #bc-btn{
display:block;
}
.ff_nav{
display:none;
}
#ff-button:hover .ff_nav{
display:block;
}

.fs_nav{
display:none;
}
#fs-button:hover .fs_nav{
display:block;
}




</style>

<body>


<div id="textarea" contenteditable="true" onkeyup="wordCount()">文本1文本2文本3文本4文本5文本6
swswhbwbyxyurhuedjAAAAAAAAAAAAAA一梦江湖风云录，孙武湖和自信色号i西四环新手机号现金转文字很危险混血儿我就我自己
我等会i动物搞笑独孤信度想问一下我想跌<b>6171hxxhhx</b>xdxdhwdihxdih<font color="red">wdwdxw第五个训诂学额wjhw</font>邪恶u邪恶也想过点我头像东莞阳光网下一位也想问下
</div>




<div class="button">
<button id="getCode" onclick="getCode();">HTML</button>

<button id="undo-button" onclick="un()">撤销</button>
<button id="redo-button" onclick="redo()">恢复</button>
<!-- 
<button id="open-button" onclick="open()">打开</button>
<button id="saveas-button" onclick="saveas()">另存为</button>
-->
<button id="rf-button" onclick="rf()">清除格式</button>

<button id="copy-button" onclick="copy()">复制</button>
----
 
<div id="ff-button">
<button>字体</button>
<div class="ff_nav">
<button id="ff1-button" onclick="ff1()">sans-serif</button>
<button id="ff2-button" onclick="ff2()">serif</button>
<button id="ff3-button" onclick="ff3()">cursive</button>
<button id="ff4-button" onclick="ff4()">monospace</button>
<button id="ff5-button" onclick="ff5()">courier</button>

</div>
</div>



<div id="fs-button">
<button >字体大小</button>

<div class="fs_nav">
<button id="fs1-button" onclick="fs1()">1</button>
<button id="fs2-button" onclick="fs2()">2</button>
<button id="fs3-button" onclick="fs3()">3</button>
<button id="fs4-button" onclick="fs4()">4</button>
<button id="fs5-button" onclick="fs5()">5</button>
<button id="fs6-button" onclick="fs6()">6</button>
<button id="fs7-button" onclick="fs7()">7</button>
</div>
</div>


<button id="b-button" onclick="b()">加粗</button>
<button id="i-button" onclick="i()">斜体</button>
<button id="u-button" onclick="u()">下划线</button>
<button id="s-button" onclick="s()">删除线</button>
<button id="super-button" onclick="superscript()">上标</button>
<button id="sub-button" onclick="subscript()">下标</button>

<div id="fc">
<button id="fc-button">字体颜色</button>
<input type="color" id="fc-thecolor" value=""/>
<button id="fc-btn" onclick="fc()">设置字体颜色</button>
</div>

<div id="bc">
<button id="bc-button">背景颜色</button>
<input type="color" id="bc-thecolor" value=""/>
<button id="bc-btn" onclick="bc()">设置背景颜色</button>
</div>

<!--链接-->


<div id="a-button">
<button id="a1-button">链接</button>
<button id="a2-button" onclick="a2()">添加链接</button>
<textarea id="href" placeholder="输入链接" value=" "></textarea>
</div>

<button id="pre-button" onclick="pre()">代码块</button>


<!--图片-->
<div id="img-button">
<button id="img1-button">图片
<input type="file" id="imagefile" value=".">
</button>
<button id="img2-button" onclick="img();">插入</button>
</div>

<button id="iu-button" onclick="iu()">无序列表</button>
<button id="io-button" onclick="io()">有序列表</button>



<button id="hr-button" onclick="hr()">分割线</button>
<button id="p-button" onclick="p()">换行</button>

<button id="in-button" onclick="indent()">缩进</button>
<button id="out-button" onclick="outdent()">减少缩进</button>



<button id="jf-button" onclick="jf()">两端对齐</button>
<button id="jc-button" onclick="jc()">居中</button>
<button id="jl-button" onclick="jl()">居左</button>
<button id="jr-button" onclick="jr()">居右</button>

<button id="h1-button" onclick="h1()">一级标题</button>
<button id="h2-button" onclick="h2()">二级标题</button>
<button id="h3-button" onclick="h3()">三级标题</button>
<button id="h4-button" onclick="h4()">四级标题</button>
<button id="h5-button" onclick="h5()">五级标题</button>
<button id="h6-button" onclick="h6()">六级标题</button>



<!--x-->
<button id="aud-button" onclick="aud()">更改浏览器自动链接行为</button>
<button id="t-button" onclick="creatTab()">表格</button>
<button id="inserttext-button" onclick="insertText()">insertText</button>


</div>

<textarea id="code">
</textarea>


<button onclick="replace()">替换</button>
<div id="output1">替换结果</div>
<div id="output2">字数</div>

</body>




<script>
<!--替换-->
function replace() {
var A = prompt("替换内容","");
var B = prompt("替换为","");
        if(A!=null&&A!=''&&B!=null&&B!=''){
var str = document.getElementById("textarea").innerHTML;
document.getElementById("textarea").innerHTML= str.replace(new RegExp(A , "g"), B);
}
}
<!--字数统计 -->
function wordCount() {
var length = document.getElementById("textarea");
document.getElementById("output2").innerHTML= length.innerHTML.length;
}



function getCode() {
var code = document.getElementById("textarea").innerHTML;
document.getElementById("code").innerText = code;
} 



function copy() {
document.execCommand("Copy")
};
//改变选中区域的字体;
function ff() {
document.execCommand("FontName","false",sFontName);
};



function ff1() {
document.execCommand("FontName","false","sans-serif");
};
function ff2() {
document.execCommand("FontName","false","serif");
};
function ff3() {
document.execCommand("FontName","false","cursive");
};
function ff4() {
document.execCommand("FontName","false","monospace");
};
function ff5() {
document.execCommand("FontName","false","courier");
};

       
//改变选中区域的字体大小;
function fs() {
document.execCommand("FontSize","false","7");
};
function fs1() {
document.execCommand("FontSize","false","1");
};
function fs2() {
document.execCommand("FontSize","false","2");
};
function fs3() {
document.execCommand("FontSize","false","3");
};
function fs4() {
document.execCommand("FontSize","false","4");
};
function fs5() {
document.execCommand("FontSize","false","5");
};
function fs6() {
document.execCommand("FontSize","false","6");
};
function fs7() {
document.execCommand("FontSize","false","7");
};

//加粗;
function b() {
document.execCommand("Bold","false",null);
}; 
//斜体   
function i(){
document.execCommand('Italic');   
};
//下划线
function u() {
document.execCommand("Underline")
} ;
//删除线
function s() {
document.execCommand("StrikeThrough")
} ;
//上标
function superscript(){
document.execCommand("SuperScript")
} ;
//下标
function subscript(){
document.execCommand('subscript', 'false', null);
};
//设置文字颜色;
function fc(){
var color =document.getElementById("fc-thecolor").value;
document.execCommand("ForeColor","false",color);
};
//设置背景颜色;
function bc(){
var color =document.getElementById("bc-thecolor").value;
document.execCommand("BackColor","false",color);
};
//链接
function a2() {
var linkURL = document.getElementById("href").value;
document.execCommand('CreateLink', true, linkURL );
};
//图片
function img(){
if(typeof FileReader=='undifined'){result.innerHTML="<p>抱歉，你的浏览器不支持 FileReader</p>";return false;}var file=document.getElementById("imagefile").files[0];
if(!/image\/\w+/.test(file.type))           
{alert("请确保文件为图像文件");return false;}
var reader=new FileReader();
reader.readAsDataURL(file);
reader.onload=function(e){
document.execCommand("insertImage",true,this.result)
}}
//显示代码
function pre(){
document.execCommand("FormatBlock",false,"<PRE>")
};
//标题
function h1(){
document.execCommand("FormatBlock","false","<h1>")
};
function h2(){
document.execCommand("FormatBlock","false","<h2>")
};
function h3(){
document.execCommand("FormatBlock","false","<h3>")
};
function h4(){
document.execCommand("FormatBlock","false","<h4>")
};
function h5(){
document.execCommand("FormatBlock","false","<h5>")
};
function h6(){
document.execCommand("FormatBlock","false","<h6>")
};



//缩进
function indent(){
document.execCommand('Indent');  
};
//减少缩进
function outdent(){
document.execCommand('outdent', 'false', null );
};


//分割线

function hr() {
document.execCommand("InsertHorizontalRule")
} ;
//换行
function p() {
document.execCommand("InsertParagraph")
} 

//文本对齐
function jf() {
document.execCommand('justifyFull', 'false', null );
};
//文本居中
function jc(){
document.execCommand('justifyCenter', 'false', null );
};
//文本左对齐
function jl(){
document.execCommand('justifyLeft', 'false', null );
};
//文本右对齐
function jr(){
document.execCommand('justifyRight', 'false', null );
};
//无序列排列   
function iu(){
document.execCommand('InsertUnorderedList');   
};

//有序列排列   
function io(){
document.execCommand('InsertOrderedList');   
};


//撤销
function un() {
document.execCommand('undo', 'false', null );
} ;
//恢复
function redo() {
document.execCommand('redo', 'false', null );
} ;
//清除格式
function rf() {
document.execCommand('RemoveFormat')
} 


<!--不会使用-->
function open() {
document.execCommand("Open")
} ;
function saveas() {
document.execCommand("SaveAs",false,"hi")
};
//更改自动链接行为
function aud() {
document.execCommand("AutoUrlDetect",true)
} 


<!--表格-->
function creatTab(){
var rows = prompt("rows"," ");
var cols = prompt("cols"," ");


var th = document.createElement('th');

    var tab = '<table id="tfhover" class="tftable" border="1" contenteditable="true">'
/* 表头*/
            tab=tab+"<tr>";
        for(var j=0;j<cols;j++){
            tab+="<th>"+1+j+"</th>";
        }
        tab+="<tr/>";
    

/* */
    for(var i=0;i<rows;i++){
        tab=tab+"<tr>";
        for(var j=0;j<cols;j++){
            tab+="<td>"+i+j+"</td>";
        }
        tab+="<tr/>";
    }
    tab+='</table>';

var html=tab;
/*来源：https://blog.csdn.net/fesfsefgs/article/details/109540259?utm_medium=distribute.wap_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-1.wap_blog_relevant_pic&depth_1-utm_source=distribute.wap_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-1.wap_blog_relevant_pic*/
var sel, range;
    if (window.getSelection) {
        sel = window.getSelection();
        if (sel.getRangeAt && sel.rangeCount) {
            range = sel.getRangeAt(0);
            range.deleteContents();
            var el = document.createElement("div");
            el.innerHTML = html;
            var frag = document.createDocumentFragment(), node, lastNode;
            while ( (node = el.firstChild) ) {
                lastNode = frag.appendChild(node);
            }
            range.insertNode(frag);

            // Preserve the selection
            if (lastNode) {
                range = range.cloneRange();
                range.setStartAfter(lastNode);
                range.collapse(true);
                sel.removeAllRanges();
                sel.addRange(range);
            }
        }
    } else if (document.selection && document.selection.type != "Control") {     document.selection.createRange().pasteHTML(html);
    }
}





    



<!--目前暂定不用-->
function insertText(){
document.execCommand('insertText', 'false', "<hi>");
};

</script>










